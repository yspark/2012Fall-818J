\section{Introduction}
\label{sec:introduction}
We present a new trojan-like passive side-channel attack on multimedia. Our goal is to reveal a title of a movie a user is watching by monitoring Central Processing Unit (CPU) usage statistics of the application which renders the movie. We exploit two distinct features of multimedia streams: variable bit rates of streams, and cpu-intensive workloads of decoding process. Multimedia streams are encoded in variable bit rates because each video frame of the streams contains varying visual information itself and visual differences to its reference video frames, which allows the video codec to exploit spatial and temporal locality, respectively. These encoding factors will affect the size of video frames and, as a result, an amount of CPU operations needed to decode a movie in a client-side. From the observation, we expect that the decoding process may generate a movie-specific CPU usage patterns, hopefully, unique ones because multimedia decoding is very CPU-intensive process. Therefore, with high probability, the attacker can identify a title of a movie by monitoring CPU usage statistics of a multimedia application.  

As preliminaries, we collect CPU usage statistics from a few movies and confirm that each movie show unique pattern of CPU usage which can be differentiated from other movie.  We also confirm that repeated measurement on a single movie show similar CPU usage patterns.  Then we implement a prototype of side-channel attack application running on Android device to prove the feasibility of our side-channel attack.  Through the prototype application, it is clearly shown that the side-channel attack can be performed on users' device without requiring any permission.

We experimentally show the feasibility and the practicability of our attack. Based on a pre-built CPU usage statistics database for a set of movies, a title of a movie, randomly selected from the set, is identified by matching a monitored CPU usage pattern against our database. We propose three pattern matching algorithms, \term{Fast subsequence Matching}, \term{K-Nearest Neighbors (KNN)} and harmonization of the two algorithms.  Fast subsequence matching algorithm converts CPU usage statistics of time domain into the sequence of spatial domain by applying \term{Discrete Fourier Transform (DFT)}.   Then the algorithm predicts a movie title by matching the pattern of the movie in spatial domain.  On the other hand, KNN predicts a movie title by matching the pattern of the movie in time domain by calculating the \term{Euclidean Distance} between patterns. 

We present experimental results of the proposed algorithms. Fast subsequence matching algorithm runs fast since it works with pre-built database of space-series sequences, but shows relatively low prediction accuracy.  On the other hand, KNN shows higher accuracy but runs slower since it matches the given sequence to all the possible sequences in the database.  The integrated algorithm harmonizes the two algorithms so that it runs faster than KNN while showing similar or better prediction accuracy than KNN. 

The proposed attack will be serious threats to users' sensitive personal information, revealing e.g. political inclination, religious interest and sexual orientation \cite{Frankowski:2006}\cite{chaabane:hal-00748162}. The threats are realistic as millions of users are watching movies on their mobile devices due to the advent of numerous web-based multimedia contents providers such as Netflix, Hulu. Also, one of the most wide-spread mobile platform, Android, allows even an unprivileged process or application to monitor CPU usage of other processes, which makes the threats more realistic. 